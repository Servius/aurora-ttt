local self = {}
CAC.LuaSnapshot = CAC.MakeConstructor (self, CAC.LuaEntryPointCollection)

CAC.SerializerRegistry:RegisterSerializable ("LuaSnapshot", 1)

function self:ctor ()
	self.EntryClassName   = "LuaSnapshotEntry"
	self.EntryConstructor = CAC.LuaSnapshotEntry
	
	local luaSourceRetriever = CAC.LuaSourceRetriever ()
	for name, f in pairs (net.Receivers) do
		local luaSnapshotEntry = CAC.LuaSnapshotEntry.FromNetReceiver (name, f, luaSourceRetriever)
		self.NetReceivers [luaSnapshotEntry:GetName ()] = luaSnapshotEntry
		self.NetReceiverCount = self.NetReceiverCount + 1
	end
	
	for name, f in pairs (concommand.GetTable ()) do
		local luaSnapshotEntry = CAC.LuaSnapshotEntry.FromConsoleCommand (name, f, luaSourceRetriever)
		self.ConsoleCommands [luaSnapshotEntry:GetName ()] = luaSnapshotEntry
		self.ConsoleCommandCount = self.ConsoleCommandCount + 1
	end
	
	for eventName, hookTable in pairs (hook.GetTable ()) do
		self.Hooks [eventName] = {}
		
		for name, f in pairs (hookTable) do
			local luaSnapshotEntry = CAC.LuaSnapshotEntry.FromHook (eventName, name, f, luaSourceRetriever)
			self.Hooks [eventName] [luaSnapshotEntry:GetName ()] = luaSnapshotEntry
			self.HookCount = self.HookCount + 1
		end
	end
end
